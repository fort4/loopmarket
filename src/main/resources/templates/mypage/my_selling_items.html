<!-- my_selling_items.html -->
<div th:fragment="content">
	<h6 class="mb-3" th:text="'판매 중인 상품 수 : ' + ${#lists.size(products)}">상품 수 확인</h6>

	<div class="table-responsive shadow-sm">
		<table class="table align-middle table-bordered text-center mb-0">
			<thead class="table-light">
				<tr>
					<th style="width: 100px;">상품</th>
					<th>상품명</th>
					<th>가격</th>
					<th>등록일</th>
					<th>상태</th>
				</tr>
			</thead>
			<tbody>
				<tr th:each="product : ${products}" th:attr="data-id=${product.productId}"
				    th:classappend="${product.isHidden} ? 'table-secondary' : ''">
					<td>
						<a th:href="@{/products/{id}(id=${product.productId})}" class="d-inline-block ratio ratio-1x1"
							style="max-width: 80px;">
							<img th:src="${product.thumbnailPath != null} ? ${product.thumbnailPath} : '/images/no-image.png'"
								alt="상품 이미지" class="img-fluid object-fit-cover" />
						</a>
					</td>
					<td>
						<a th:href="@{/products/{id}(id=${product.productId})}" class="text-decoration-none text-dark">
							<span th:text="${product.title}">상품명</span>
						</a>
					</td>
					<td th:text="'₩' + ${product.price}">가격</td>
					<td th:text="${#temporals.format(product.createdAt, 'yyyy-MM-dd')}">등록일</td>
					<td>
						<!-- 상태 선택 (숨김 아닐 때만) -->
						<select class="form-select form-select-sm d-inline w-auto me-2"
						        th:if="${!product.isHidden}"
						        data-status-change
						        th:attr="data-id=${product.productId}">
						  <option value="ONSALE" th:selected="${product.status == 'ONSALE'}">판매중</option>
						  <option value="RESERVED" th:selected="${product.status == 'RESERVED'}">예약중</option>
						</select>

						<!-- 숨김 토글 버튼 -->
						<button type="button"
						        class="btn btn-sm btn-outline-secondary btn-toggle-hide"
						        th:attr="data-id=${product.productId}"
						        th:text="${product.isHidden} ? '숨김 해제' : '숨김 처리'">
						    숨김 처리
						</button>
					</td>
				</tr>
				<!-- 판매 중 상품이 없을 경우 -->
				<tr th:if="${#lists.isEmpty(products)}">
					<td colspan="4" class="text-center text-muted py-4">판매 중인 상품이 없습니다.</td>
				</tr>
			</tbody>
		</table>
	</div>
</div>